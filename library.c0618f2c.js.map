{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,8FAiBA,EAAAC,EAAAC,WAAU,YAEV,EAAAC,EAAAC,oBAAmBL,EAAAM,MAAM,SAAAC,GACvB,GAAIA,EAAM,CACIA,EAAKC,IACjBC,aAAaC,QAAQ,OAAQ,IAC7B,EAAAR,EAAAS,mBAEA,EAAAT,EAAAU,kB,MAGAC,QAAQC,IAAI,sBACZL,aAAaC,QAAQ,OAAQ,GAC7BK,SAASC,QAAQ,e,IAQrB,IAAMC,EAAM,IAAI,EAAAC,EAAAC,SAEVC,EAAWC,SAASC,cAAc,0BAKlCC,GAJYF,SAASC,cAAc,iBAGvB,CAAC,MAAO,OAAQ,QACTE,IAAIP,EAAIQ,eACjCC,QAAQC,IAAIJ,GACTK,MAAK,SAACC,IAKT,SAA8BC,GAC5BjB,QAAQC,IAAIgB,GACZ,IAAMC,EAAYD,EACfN,KAAI,SAAAQ,GACH,IA8CkBC,EAChBC,EA9CAC,EAMEH,EANFG,eACAC,EAKEJ,EALFI,YACAC,EAIEL,EAJFK,aACAC,EAGEN,EAHFM,aACAC,EAEEP,EAFFO,OACAC,EACER,EADFQ,GAEIC,EAAUF,EAAOf,KAAI,SAAAkB,G,OAASA,EAAMF,E,IAEpCG,EAAO,IAAIC,KAAKN,GAAcO,cACpC,MAAO,gBAIyBC,OAJTN,EAAG,wNAW2BM,QAwBnCb,EA/B6BG,EAgC7CF,EACJ,6DAEKD,EACH,kCAA6Ca,OAAXb,GAClCC,GArC4D,wUASFY,OAFLX,EAAe,uIAIlDW,OA6BxB,SAAmBC,GAEjB,I,kBACEC,EAAAC,GAAMV,OAAOW,MAAK,SAAAC,G,IAAGX,EAAEW,EAAFX,GAAIY,EAAID,EAAJC,KACnBZ,IAAOO,EAAIM,IACbC,EAASC,KAAKH,E,KAJhBE,EAAW,GACNE,EAAI,EAAGA,EAAIT,EAAIU,OAAQD,GAAK,EAACE,EAAAF,GAOlCF,EAASG,OAAS,GACpBH,EAASK,OAAO,EAAG,EAAG,SAExB,OAAOL,C,CA3CuDM,CACxDnB,GACAoB,KAAK,MAAM,OACgEf,OAD3DH,EAAK,8FAGrBG,OAF2ET,EAAayB,QACxF,GACA,yG,IAKHD,KAAK,IACRzC,EAAS2C,UAAYhC,C,CA3CnBiC,CAAqBnC,E,IAEtBoC,MAAMpD,QAAQC,I","sources":["src/library.js"],"sourcesContent":["import { auth } from './js/firebase/auth';\nimport {\n  // createUserWithEmailAndPassword,\n  // signInWithEmailAndPassword,\n  onAuthStateChanged,\n} from 'firebase/auth';\nimport refs from './js/refs';\nimport {\n  addAuthBtns,\n  removeAuthBtns,\n  addNav,\n  removeNav,\n  renderNav,\n  addLogOutButton,\n} from './js/auth/auth-nav';\nimport { insertData, readData } from './js/firebase/db-service';\n\nrenderNav('library');\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    const uid = user.uid;\n    localStorage.setItem('auth', 1);\n    removeAuthBtns();\n    // addNav('library');\n    addLogOutButton();\n    // insertData(7, 'watchlist');\n  } else {\n    console.log('User is signed out');\n    localStorage.setItem('auth', 0);\n    location.replace('./index.html');\n  }\n});\n\nimport MovieApiService from './js/movie-service';\nimport genre from './genres.json';\nimport { showInfoModal } from './js/model-info-film';\n\nconst api = new MovieApiService()\n\nconst cardList = document.querySelector('.js-films-list-library')\nconst infoModal = document.querySelector('.modal-holder')\n\n\nconst watchlist = [49046, 913290, 766475];\nconst movies = watchlist.map(api.getMovieInfo);\nPromise.all(movies)\n  .then((array) => {\n    createFilmCardMarkup(array);\n  })\n  .catch(console.log);\n\nfunction createFilmCardMarkup(films) {\n  console.log(films)\n  const newMarkup = films\n    .map(film => {\n      const {\n        original_title,\n        poster_path,\n        vote_average,\n        release_date,\n        genres,\n        id,\n      } = film;\n      const fIlmIds = genres.map(genre => genre.id\n      )\n      const year = new Date(release_date).getFullYear();\n      return `<li data-id=\"${id}\" class=\"card film-card\">\n                        <div class=\"film-card__img-wrap\">\n                            <img\n                                class=\"film-card__img\"\n                                src=${fetchFilmPhoto(poster_path)}\n                                alt=\"Poster to movie\"\n                                width=\"395\"\n                                height=\"574\"\n                            />\n                        </div>\n                        <div class=\"film-card__wrap\">\n                            <h2 class=\"film-card__title\">${original_title}</h2>\n                            <div class=\"film-card__wrapper\">\n                                <span class=\"film-card__info\">${getGenres(\n        fIlmIds\n      ).join(', ')} | ${year}</span>\n                                <span data-film-rating class=\"film-card__rating\">${vote_average.toFixed(\n        2\n      )}</span>\n                            </div>\n                        </div>\n                    </li>`;\n    })\n    .join('');\n  cardList.innerHTML = newMarkup;\n\n  // cardList.addEventListener('click', event => {\n  //   const card = event.target.closest('li');\n  //   if (card) {\n  //     const cardId = card.getAttribute('data-id');\n  //     showInfoModal(infoModal, api, cardId);\n  //   }\n  // });\n}\n\nfunction fetchFilmPhoto(posterPath) {\n  const noPosterAvaliable =\n    'https://www.reelviews.net/resources/img/default_poster.jpg';\n\n  return posterPath\n    ? `https://image.tmdb.org/t/p/w500${posterPath}`\n    : noPosterAvaliable;\n}\n\nfunction getGenres(ids) {\n  let newArray = [];\n  for (let i = 0; i < ids.length; i += 1) {\n    genre.genres.find(({ id, name }) => {\n      if (id === ids[i]) {\n        newArray.push(name);\n      }\n    });\n  }\n  if (newArray.length > 2) {\n    newArray.splice(2, 3, 'Other');\n  }\n  return newArray;\n}"],"names":["$cO4lv","parcelRequire","$kuom3","renderNav","$3SEMc","onAuthStateChanged","auth","user","uid","localStorage","setItem","removeAuthBtns","addLogOutButton","console","log","location","replace","$cecbdd76f2d3d4bd$var$api","$h4uzj","default","$cecbdd76f2d3d4bd$var$cardList","document","querySelector","$cecbdd76f2d3d4bd$var$movies","map","getMovieInfo","Promise","all","then","array","films","newMarkup","film","posterPath","noPosterAvaliable","original_title","poster_path","vote_average","release_date","genres","id","fIlmIds","genre1","year","Date","getFullYear","concat","ids","$parcel$interopDefault","$fKcg4","find","param","name","i","newArray","push","i1","length","_loop","splice","$cecbdd76f2d3d4bd$var$getGenres","join","toFixed","innerHTML","$cecbdd76f2d3d4bd$var$createFilmCardMarkup","catch"],"version":3,"file":"library.c0618f2c.js.map"}