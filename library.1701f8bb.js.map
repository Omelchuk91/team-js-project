{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,sHAiBA,EAAAC,EAAAC,WAAU,YAEV,EAAAC,EAAAC,oBAAmBC,EAAAC,MAAM,SAAAC,GACvB,GAAIA,EAAM,CACIA,EAAKC,IACjBC,aAAaC,QAAQ,OAAQ,IAC7B,EAAAT,EAAAU,mBAEA,EAAAV,EAAAW,kB,MAGAC,QAAQC,IAAI,sBACZL,aAAaC,QAAQ,OAAQ,GAC7BK,SAASC,QAAQ,e,IAQrB,IAAMC,EAAM,IAAI,EAAAC,EAAAC,SAEVC,EAAWC,SAASC,cAAc,0BACtBD,SAASC,cAAc,iB,SAK1BC,I,OAAAA,EAAfC,EAAAzB,EAAA,CAAAyB,EAAAC,GAAAC,MAAA,SAAAC,EAA0BC,G,yEACxBC,EAAAV,QAAKW,eAAeC,UAAY,+B,SAC1BC,QAAQC,IAAIL,GACfM,MAAK,SAAAC,GACJN,EAAAV,QAAKW,eAAeC,UAAY,GAChCK,EAAqBD,E,IAEtBE,MAAMxB,QAAQC,K,4CAPMwB,MAAAC,KAAAC,U,CAYzB,SAASJ,EAAqBK,GAC5B5B,QAAQC,IAAI2B,GACZ,IAAMC,EAAYD,EACfE,KAAI,SAAAC,GACH,IA6CkBC,EAChBC,EA7CAC,EAMEH,EANFG,eACAC,EAKEJ,EALFI,YACAC,EAIEL,EAJFK,aACAC,EAGEN,EAHFM,aACAC,EAEEP,EAFFO,OACAC,EACER,EADFQ,GAEIC,EAAUF,EAAOR,KAAI,SAAAW,G,OAASA,EAAMF,E,IACpCG,EAAO,IAAIC,KAAKN,GAAcO,cACpC,MAAO,gBAIyBC,OAJTN,EAAG,wNAW2BM,QAwBnCb,EA/B6BG,EAgC7CF,EACJ,6DAEKD,EACH,kCAA6Ca,OAAXb,GAClCC,GArC4D,wUASFY,OAFLX,EAAe,uIAIxBW,OA6BlD,SAAmBC,GAEjB,I,kBACEnC,EAAAoC,GAAMT,OAAOU,MAAK,SAAAC,G,IAAGV,EAAEU,EAAFV,GAAIW,EAAID,EAAJC,KACnBX,IAAOO,EAAIK,IACbC,EAASC,KAAKH,E,KAJhBE,EAAW,GACNE,EAAI,EAAGA,EAAIR,EAAIS,OAAQD,GAAK,EAACE,EAAAF,GAOlCF,EAASG,OAAS,GACpBH,EAASK,OAAO,EAAG,EAAG,SAExB,OAAOL,C,CA3CuDM,CAC9BlB,GACAmB,KAAK,MAAM,OACsCd,OADjCH,EAAK,8FAGrBG,OAFiDT,EAAawB,QAC9D,GACA,yG,IAK7BD,KAAK,IACRpD,EAASW,UAAYW,C,WAlDGd,GAAXL,EAAUe,MAAAC,KAAAC,U,CAUzBkC,CAbkB,CAAC,MAAO,OAAQ,QACT/B,IAAI1B,EAAI0D,c","sources":["src/library.js"],"sourcesContent":["import { auth } from './js/firebase/auth';\nimport {\n  // createUserWithEmailAndPassword,\n  // signInWithEmailAndPassword,\n  onAuthStateChanged,\n} from 'firebase/auth';\nimport refs from './js/refs';\nimport {\n  addAuthBtns,\n  removeAuthBtns,\n  addNav,\n  removeNav,\n  renderNav,\n  addLogOutButton,\n} from './js/auth/auth-nav';\nimport { insertData, readData } from './js/firebase/db-service';\n\nrenderNav('library');\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    const uid = user.uid;\n    localStorage.setItem('auth', 1);\n    removeAuthBtns();\n    // addNav('library');\n    addLogOutButton();\n    // insertData(7, 'watchlist');\n  } else {\n    console.log('User is signed out');\n    localStorage.setItem('auth', 0);\n    location.replace('./index.html');\n  }\n});\n\nimport MovieApiService from './js/movie-service';\nimport genre from './genres.json';\nimport { showInfoModal } from './js/model-info-film';\n\nconst api = new MovieApiService();\n\nconst cardList = document.querySelector('.js-films-list-library');\nconst infoModal = document.querySelector('.modal-holder');\n\nconst watchlist = [49046, 913290, 766475];\nconst movies = watchlist.map(api.getMovieInfo);\n\nasync function promiceAll(movies) {\n  refs.filmsContainer.innerHTML = '<span class=\"loader\"></span>';\n  await Promise.all(movies)\n    .then(array => {\n      refs.filmsContainer.innerHTML = '';\n      createFilmCardMarkup(array);\n    })\n    .catch(console.log);\n}\n\npromiceAll(movies);\n\nfunction createFilmCardMarkup(films) {\n  console.log(films);\n  const newMarkup = films\n    .map(film => {\n      const {\n        original_title,\n        poster_path,\n        vote_average,\n        release_date,\n        genres,\n        id,\n      } = film;\n      const fIlmIds = genres.map(genre => genre.id);\n      const year = new Date(release_date).getFullYear();\n      return `<li data-id=\"${id}\" class=\"card film-card\">\n                        <div class=\"film-card__img-wrap\">\n                            <img\n                                class=\"film-card__img\"\n                                src=${fetchFilmPhoto(poster_path)}\n                                alt=\"Poster to movie\"\n                                width=\"395\"\n                                height=\"574\"\n                            />\n                        </div>\n                        <div class=\"film-card__wrap\">\n                            <h2 class=\"film-card__title\">${original_title}</h2>\n                            <div class=\"film-card__wrapper\">\n                                <span class=\"film-card__info\">${getGenres(\n                                  fIlmIds\n                                ).join(', ')} | ${year}</span>\n                                <span data-film-rating class=\"film-card__rating\">${vote_average.toFixed(\n                                  2\n                                )}</span>\n                            </div>\n                        </div>\n                    </li>`;\n    })\n    .join('');\n  cardList.innerHTML = newMarkup;\n\n  // cardList.addEventListener('click', event => {\n  //   const card = event.target.closest('li');\n  //   if (card) {\n  //     const cardId = card.getAttribute('data-id');\n  //     showInfoModal(infoModal, api, cardId);\n  //   }\n  // });\n}\n\nfunction fetchFilmPhoto(posterPath) {\n  const noPosterAvaliable =\n    'https://www.reelviews.net/resources/img/default_poster.jpg';\n\n  return posterPath\n    ? `https://image.tmdb.org/t/p/w500${posterPath}`\n    : noPosterAvaliable;\n}\n\nfunction getGenres(ids) {\n  let newArray = [];\n  for (let i = 0; i < ids.length; i += 1) {\n    genre.genres.find(({ id, name }) => {\n      if (id === ids[i]) {\n        newArray.push(name);\n      }\n    });\n  }\n  if (newArray.length > 2) {\n    newArray.splice(2, 3, 'Other');\n  }\n  return newArray;\n}\n"],"names":["$bpxeT","parcelRequire","$kuom3","renderNav","$3SEMc","onAuthStateChanged","$cO4lv","auth","user","uid","localStorage","setItem","removeAuthBtns","addLogOutButton","console","log","location","replace","$cecbdd76f2d3d4bd$var$api","$h4uzj","default","$cecbdd76f2d3d4bd$var$cardList","document","querySelector","$cecbdd76f2d3d4bd$var$_promiceAll","$parcel$interopDefault","$2TvXO","mark","_callee","movies1","$4Nugj","filmsContainer","innerHTML","Promise","all","then","array","$cecbdd76f2d3d4bd$var$createFilmCardMarkup","catch","apply","this","arguments","films","newMarkup","map","film","posterPath","noPosterAvaliable","original_title","poster_path","vote_average","release_date","genres","id","fIlmIds","genre1","year","Date","getFullYear","concat","ids","$fKcg4","find","param","name","i","newArray","push","i1","length","_loop","splice","$cecbdd76f2d3d4bd$var$getGenres","join","toFixed","$cecbdd76f2d3d4bd$var$promiceAll","getMovieInfo"],"version":3,"file":"library.1701f8bb.js.map"}